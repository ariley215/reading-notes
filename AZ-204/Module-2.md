# Configure Web App Settings

- Create application settings that are bound to deployment slots.
- Explain the options for installing SSL/TLS certificates for your app.
- Enable diagnostic logging for your app to aid in monitoring and debugging.
- Create virtual app to directory mappings

In App Service, app settings are variables passed as environment variables to the application code.

- For **Linux** apps and custom containers, App Service passes app settings to the container using the --env flag to set the environment variable in the container.

App settings are always encrypted when stored (encrypted-at-rest).

## Adding and editing settings

To add a new app setting, select New application setting. If you're using deployment slots you can specify if your setting is swappable or not. In the dialog, you can stick the setting to the current slot.

In a default, or custom, Linux container any nested JSON key structure in the app setting name like ApplicationInsights:InstrumentationKey needs to be configured in App Service as ApplicationInsights__InstrumentationKey for the key name. In other words, any : should be replaced by__ (double underscore).

To add or edit app settings in bulk, select the Advanced edit button.

this is the format:

```json
[
  {
    "name": "<key-1>",
    "value": "<value-1>",
    "slotSetting": false
  },
  {
    "name": "<key-2>",
    "value": "<value-2>",
    "slotSetting": false
  },
  ...
]
```

## Configure connection strings

For ASP.NET and ASP.NET Core developers, the values you set in App Service override the ones in Web.config.

For others, better to use app settings.

- connection strings require special formatting in the variable keys in order to access the values.
- Connection strings are always encrypted when stored (encrypted-at-rest)
- Adding and editing connection strings follow the same principles as other app settings
*There is one case where you may want to use connection strings instead of app settings for non-.NET languages: certain Azure database types are backed up along with the app only if you configure a connection string for the database in your App Service app.*

ex.
```json
[
  {
    "name": "name-1",
    "value": "conn-string-1",
    "type": "SQLServer",
    "slotSetting": false
  },
  {
    "name": "name-2",
    "value": "conn-string-2",
    "type": "PostgreSQL",
    "slotSetting": false
  },
  ...
]
```

## General Settings

A list of the currently available settings:

1. Stack Setting

- The software stack to run the app, including the language and SDK versions. For Linux apps and custom container apps, you can also set an optional start-up command or file.

1. Platform settings: settings for the hosting platform

- Bitness: 32-bit or 64-bit.
- WebSocket protocol
- Always On
  - Keep the app loaded even when there's no traffic.
  - By default, Always On isn't enabled and the app is unloaded after 20 minutes without any incoming requests.
- Managed pipline version- IIS pipeline mode
- HTTP Version
- ARR affinity

1. Debugging
1. Incoming client certificates

- require client certificates in mutual authentication. TLS mutual authentication is used to restrict access to your app by enabling different types of authentication for it.

## Configure path mappings

Configure handler mappings, and virtual application and directory mappings.

### Windows apps (uncontainerized)

**Handler mappings** let you add custom script processors to handle requests for specific file extensions.

settings:

- Extension
- Script processor
- arguments

Each app has the default root path (/) mapped to **D:\home\site\wwwroot**, where your code is deployed by default. 

If your app root is in a different folder, or if your repository has more than one application, you can edit or add virtual applications and directories.

### Linux and containerized apps

You can add custom storage for your containerized app(all linux apps and any systems custom container).

**Name:** The display name.

**Configuration options:** Basic or Advanced.

**Storage accounts:** The storage account with the container you want.

**Storage type:** Azure Blobs or Azure Files. Windows container apps only support Azure Files.

**Storage container:** For basic configuration, the container you want.

**Share name:** For advanced configuration, the file share name.

**Access key:** For advanced configuration, the access key.

**Mount path:** The absolute path in your container to mount the custom storage.

## Enable diagnostic logging

There are built-in diagnostics to assist with debugging an App Service app

| Type | Platform | Location | Description
|---|---|---|---
| Application Logging | Windows, Linux | App Service file system and/or Azure Storage blobs | Logs messages generated by your application code. The messages are generated by the web framework you choose, or from your application code directly using the standard logging pattern of your language. Each message is assigned one of the following categories: Critical, Error, Warning, Info, Debug, and Trace
| Web Server logging | Windows | App Service file system or Azure Storage blobs | Raw HTTP request data in the W3C extended log file format. Each log message includes data like the HTTP method, resource URI, client IP, client port, user agent, response code, and so on
| Detailed error logging | Windows | App Service file system | Copies of the .html error pages that would have been sent to the client browser. For security reasons, detailed error pages shouldn't be sent to clients in production, but App Service can save the error page each time an application error occurs that has HTTP code 400 or greater
| Failed request tracing | Windows | App Service file system | Detailed tracing information on failed requests, including a trace of the IIS components used to process the request and the time taken in each component. One folder is generated for each failed request, which contains the XML log file, and the XSL stylesheet to view the log file with.
| Deployment logging| Windows, Linux | App Service file system | Helps determine why a deployment failed. Deployment logging happens automatically and there are no configurable settings for deployment logging

### Enable application logging

In App Service logs:

- Select On for either Application Logging (Filesystem) or Application Logging (Blob), or both.
  - The Filesystem option is for temporary debugging purposes, and turns itself off in 12 hours.
  - The Blob option is for long-term logging, and needs a blob storage container to write logs to.

*If you regenerate your storage account's access keys, you must reset the respective logging configuration to use the updated access keys. To do this turn the logging feature off and then on again.*

- Set the Level of details included in the log as shown in the following table.

  - Disabled: None
  - Error: Error, Critical
  - Warning: Warning, error, critical
  - Information: Inof, warning, error, critical
  - Verbose: Trace, debugg, info, warning, error, critical(all categories)
